<!-- Profile Edit Page -->
<div class="profile-edit-page">
  
  <!-- Header -->
  <div class="edit-header">
    <div class="header-content">
      <div class="header-nav">
        <button class="nav-back" (click)="navigateBack()">
          <span class="nav-icon">←</span>
          <span class="nav-text">Voltar</span>
        </button>
      </div>
      
      <div class="header-info">
        <h1 class="header-title">Editar Perfil</h1>
        <p class="header-subtitle">Atualize suas informações pessoais</p>
      </div>
    </div>
  </div>

  <!-- Form Content -->
  <div class="edit-content">
    <div class="container">
      
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="profile-form">
        
        <!-- Profile Photo Section -->
        <div class="form-section">
          <h2 class="section-title"><i class="bi bi-image"></i> Foto de Perfil</h2>
          
          <div class="photo-section">
            <div class="current-photo">
              <img 
                [src]="imagePreview || currentUser?.photoURL || 'assets/default-avatar.png'" 
                [alt]="currentUser?.displayName || 'Avatar'"
                class="photo-preview"
              >
            </div>
            
            <div class="photo-form">
              <div class="form-group">
                <label for="photoURL">URL da Foto</label>
                <input 
                  id="photoURL" 
                  formControlName="photoURL" 
                  placeholder="https://exemplo.com/foto.jpg"
                  (input)="onImageUrlChange()"
                  [class.error]="hasError('photoURL')"
                >
                <span class="error-message" *ngIf="hasError('photoURL')">{{ getError('photoURL') }}</span>
                <small class="field-hint">Cole o link de uma imagem hospedada online (JPG, PNG, GIF, WebP)</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Basic Information Section -->
        <div class="form-section">
          <h2 class="section-title"><i class="bi bi-file-text"></i> Informações Básicas</h2>
          
          <div class="form-grid">
            <!-- Display Name -->
            <div class="form-group span-2">
              <label for="displayName">Nome de Exibição *</label>
              <input 
                id="displayName" 
                formControlName="displayName" 
                placeholder="Como você quer ser chamado"
                [class.error]="hasError('displayName')"
              >
              <span class="error-message" *ngIf="hasError('displayName')">{{ getError('displayName') }}</span>
            </div>

            <!-- Bio -->
            <div class="form-group span-2">
              <label for="bio">Biografia</label>
              <textarea 
                id="bio" 
                formControlName="bio" 
                rows="4" 
                placeholder="Conte um pouco sobre você, seus interesses, hobbies..."
                [class.error]="hasError('bio')"
                maxlength="500"
              ></textarea>
              <div class="field-info">
                <span class="error-message" *ngIf="hasError('bio')">{{ getError('bio') }}</span>
                <span class="character-count">{{ getCharacterCount('bio') }}/500</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Location Section -->
        <div class="form-section">
          <h2 class="section-title"><i class="bi bi-geo-alt"></i> Localização</h2>
          
          <div class="form-grid" formGroupName="location">
            <!-- City -->
            <div class="form-group">
              <label for="city">Cidade</label>
              <input 
                id="city" 
                formControlName="city" 
                placeholder="Ex: Salvador"
                [class.error]="hasError('location.city')"
              >
              <span class="error-message" *ngIf="hasError('location.city')">{{ getError('location.city') }}</span>
            </div>

            <!-- State -->
            <div class="form-group">
              <label for="state">Estado</label>
              <input 
                id="state" 
                formControlName="state" 
                placeholder="Ex: BA"
                [class.error]="hasError('location.state')"
              >
              <span class="error-message" *ngIf="hasError('location.state')">{{ getError('location.state') }}</span>
            </div>
          </div>
        </div>

        <!-- Account Information Section -->
        <div class="form-section">
          <h2 class="section-title"><i class="bi bi-shield-lock"></i> Informações da Conta</h2>
          
          <div class="account-info">
            <div class="info-item">
              <label>E-mail</label>
              <div class="readonly-field">{{ currentUser?.email }}</div>
              <small class="field-hint">O e-mail não pode ser alterado por aqui</small>
            </div>
            
            <div class="info-item">
              <label>ID do Usuário</label>
              <div class="readonly-field">{{ currentUser?.uid }}</div>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-secondary"
            (click)="navigateBack()"
            [disabled]="isSaving"
          >
            <span *ngIf="!isSaving"><i class="bi bi-x-lg"></i> Cancelar</span>
          </button>
          
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="profileForm.invalid || isSaving"
          >
            <span *ngIf="!isSaving"><i class="bi bi-check-lg"></i> Salvar Alterações</span>
            <span *ngIf="isSaving"><i class="bi bi-hourglass-split"></i> Salvando...</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
